# Piano Practice App

ä¸€ä¸ªåŸºäº React Native (Expo) çš„é’¢ç´äº”çº¿è°±ç»ƒä¹ åº”ç”¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ¨ äº”çº¿è°±å¯è§†åŒ–å±•ç¤º
- ğŸ¹ è™šæ‹Ÿé’¢ç´é”®ç›˜ (2ä¸ªå…«åº¦)
- ğŸµ å®æ—¶éŸ³ç¬¦è¯†åˆ«å’Œåé¦ˆ
- ğŸ“Š ç»ƒä¹ ç»Ÿè®¡ (æ­£ç¡®ç‡ã€è¿›åº¦)
- ğŸ¯ æ™ºèƒ½é«˜äº®å½“å‰å¾…å¼¹å¥éŸ³ç¬¦
- ğŸ”„ å¯é‡ç½®ç»ƒä¹ è¿›åº¦

## æŠ€æœ¯æ ˆ

- **React Native** (Expo)
- **TypeScript** - ç±»å‹å®‰å…¨
- **Zustand** - çŠ¶æ€ç®¡ç†
- **React Native SVG** - äº”çº¿è°±æ¸²æŸ“
- **Expo AV** - éŸ³é¢‘å¤„ç†

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/          # UI ç»„ä»¶
â”‚   â”œâ”€â”€ Staff/          # äº”çº¿è°±ç»„ä»¶
â”‚   â”œâ”€â”€ PianoKeyboard/  # é’¢ç´é”®ç›˜ç»„ä»¶
â”‚   â””â”€â”€ FeedbackOverlay/
â”œâ”€â”€ screens/            # é¡µé¢
â”‚   â””â”€â”€ PracticeScreen.tsx
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ AudioManager.ts
â”‚   â””â”€â”€ InputRecognitionEngine.ts
â”œâ”€â”€ store/              # çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ practiceStore.ts
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ musicUtils.ts
â””â”€â”€ types/              # TypeScript ç±»å‹
    â””â”€â”€ music.types.ts
```

## å®‰è£…å’Œè¿è¡Œ

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. EAS äº‘æ„å»ºï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

ä½¿ç”¨ Expo Application Services è¿›è¡Œäº‘æ„å»ºï¼Œæ— éœ€æœ¬åœ°é…ç½® Xcode æˆ– Android Studioã€‚

#### å¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£… EAS CLIï¼ˆå…¨å±€å®‰è£…ä¸€æ¬¡å³å¯ï¼‰
npm install -g eas-cli

# 2. ç™»å½• Expo è´¦å·
eas login

# 3. æ„å»º Android é¢„è§ˆç‰ˆï¼ˆæ¨èç¬¬ä¸€æ¬¡å°è¯•ï¼‰
npm run build:android:preview
# æˆ–ä½¿ç”¨å®Œæ•´å‘½ä»¤
eas build --platform android --profile preview

# 4. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆçº¦ 5-15 åˆ†é’Ÿï¼‰
# 5. ä¸‹è½½ç”Ÿæˆçš„ APK æ–‡ä»¶å¹¶å®‰è£…åˆ°è®¾å¤‡æµ‹è¯•
```

#### æ‰€æœ‰å¯ç”¨çš„æ„å»ºå‘½ä»¤

```bash
# Android æ„å»º
npm run build:android:preview      # é¢„è§ˆç‰ˆ APKï¼ˆæµ‹è¯•ç”¨ï¼‰
npm run build:android:production   # ç”Ÿäº§ç‰ˆ APKï¼ˆå‘å¸ƒç”¨ï¼‰
npm run build:android:aab          # AAB æ ¼å¼ï¼ˆGoogle Play ä¸Šä¼ ç”¨ï¼‰

# iOS æ„å»º
npm run build:ios:preview          # é¢„è§ˆç‰ˆï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰
npm run build:ios:production       # ç”Ÿäº§ç‰ˆï¼ˆApp Storeï¼‰

# åŒæ—¶æ„å»ºä¸¤ä¸ªå¹³å°
npm run build:all:preview          # é¢„è§ˆç‰ˆ
npm run build:all:production       # ç”Ÿäº§ç‰ˆ

# æäº¤åˆ°åº”ç”¨å•†åº—
npm run submit:android             # æäº¤åˆ° Google Play
npm run submit:ios                 # æäº¤åˆ° App Store

# æŸ¥çœ‹æ„å»ºçŠ¶æ€
npm run build:list                 # æŸ¥çœ‹æ‰€æœ‰æ„å»º
npm run build:status               # æŸ¥çœ‹æœ€è¿‘ 5 ä¸ªæ„å»º
```

**è¯¦ç»†çš„ EAS æ„å»ºæŒ‡å—**: è¯·æŸ¥çœ‹ [EAS_BUILD_GUIDE.md](./EAS_BUILD_GUIDE.md)

---

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm start
```

### 3. åœ¨è®¾å¤‡ä¸Šè¿è¡Œ

å¯åŠ¨åï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªäºŒç»´ç ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿è¡Œåº”ç”¨ï¼š

#### iOS
- åœ¨ iPhone ä¸Šä¸‹è½½ **Expo Go** åº”ç”¨
- æ‰“å¼€ç›¸æœºæ‰«æäºŒç»´ç 

#### Android
- åœ¨ Android è®¾å¤‡ä¸Šä¸‹è½½ **Expo Go** åº”ç”¨
- åœ¨ Expo Go ä¸­æ‰«æäºŒç»´ç 

#### Web (å¯é€‰)
- æŒ‰ `w` é”®åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€

#### iOS æ¨¡æ‹Ÿå™¨ (éœ€è¦ Xcode)
```bash
npm run ios
```

#### Android æ¨¡æ‹Ÿå™¨ (éœ€è¦ Android Studio)
```bash
npm run android
```

## ä½¿ç”¨è¯´æ˜

1. **å¼€å§‹ç»ƒä¹ **: åº”ç”¨å¯åŠ¨åä¼šè‡ªåŠ¨åŠ è½½ä¸€ä¸ªç®€å•çš„ C å¤§è°ƒéŸ³é˜¶ç»ƒä¹ 
2. **å¼¹å¥éŸ³ç¬¦**: ç‚¹å‡»å±å¹•ä¸‹æ–¹çš„è™šæ‹Ÿé’¢ç´é”®ç›˜
3. **æŸ¥çœ‹åé¦ˆ**:
   - æ©™è‰²åœ†åœˆ = å½“å‰å¾…å¼¹å¥çš„éŸ³ç¬¦
   - ç»¿è‰²åœ†åœˆ = å¼¹å¥æ­£ç¡®
   - çº¢è‰²åœ†åœˆ = å¼¹å¥é”™è¯¯
   - ç°è‰²åœ†åœˆ = å·²å®Œæˆ
4. **é‡æ–°å¼€å§‹**: ç‚¹å‡»"é‡æ–°å¼€å§‹"æŒ‰é’®é‡ç½®ç»ƒä¹ 

## æ ¸å¿ƒç»„ä»¶è¯´æ˜

### StaffRenderer (äº”çº¿è°±æ¸²æŸ“å™¨)
ä½¿ç”¨ React Native SVG ç»˜åˆ¶äº”çº¿è°±å’ŒéŸ³ç¬¦ï¼Œæ”¯æŒï¼š
- é«˜éŸ³è°±å·å’Œä½éŸ³è°±å·
- éŸ³ç¬¦é«˜äº®å’ŒçŠ¶æ€æ˜¾ç¤º
- æ°´å¹³æ»šåŠ¨æŸ¥çœ‹é•¿ä¹è°±

### PianoKeyboard (è™šæ‹Ÿé’¢ç´é”®ç›˜)
- åŠ¨æ€ç”ŸæˆæŒ‡å®šå…«åº¦çš„é’¢ç´é”®
- ç™½é”®å’Œé»‘é”®çš„æ­£ç¡®å¸ƒå±€
- è§¦æ‘¸åé¦ˆ

### InputRecognitionEngine (è¾“å…¥è¯†åˆ«å¼•æ“)
- éªŒè¯ç”¨æˆ·è¾“å…¥çš„éŸ³ç¬¦æ˜¯å¦æ­£ç¡®
- è·Ÿè¸ªç»ƒä¹ è¿›åº¦
- è®¡ç®—å‡†ç¡®ç‡

### usePracticeStore (çŠ¶æ€ç®¡ç†)
ä½¿ç”¨ Zustand ç®¡ç†å…¨å±€çŠ¶æ€ï¼š
- å½“å‰ä¹è°±
- éŸ³ç¬¦çŠ¶æ€
- ç»Ÿè®¡æ•°æ®
- åé¦ˆæ¶ˆæ¯

## å·²çŸ¥é—®é¢˜

1. **éŸ³é¢‘æ’­æ”¾**: å½“å‰éŸ³é¢‘ç®¡ç†å™¨ä½¿ç”¨çš„æ˜¯ç®€åŒ–å®ç°ï¼Œå®é™…éŸ³é¢‘æ’­æ”¾åŠŸèƒ½éœ€è¦ï¼š
   - å‡†å¤‡é’¢ç´éŸ³é¢‘æ–‡ä»¶ (88ä¸ªéŸ³ç¬¦)
   - æˆ–ä½¿ç”¨éŸ³é¢‘åˆæˆåº“ (å¦‚ Tone.js)

2. **ç‰ˆæœ¬è­¦å‘Š**:
   - `react-native-screens` å’Œ `react-native-svg` çš„ç‰ˆæœ¬å¯èƒ½ä¸ Expo SDK ä¸å®Œå…¨åŒ¹é…
   - è¿™ä¸ä¼šå½±å“åŸºæœ¬åŠŸèƒ½ï¼Œä½†å¦‚æœé‡åˆ°é—®é¢˜å¯ä»¥è¿è¡Œï¼š
   ```bash
   npx expo install --fix
   ```

## æœªæ¥è®¡åˆ’

- [ ] å®ç°çœŸå®çš„é’¢ç´éŸ³é¢‘æ’­æ”¾
- [ ] æ·»åŠ æ›´å¤šç»ƒä¹ æ›²ç›®
- [ ] æ”¯æŒåŒæ‰‹ç»ƒä¹  (é«˜éŸ³è°±å· + ä½éŸ³è°±å·)
- [ ] æ·»åŠ èŠ‚æ‹å™¨åŠŸèƒ½
- [ ] å®ç°ç»ƒä¹ å†å²è®°å½•
- [ ] æ”¯æŒè‡ªå®šä¹‰ä¹è°±å¯¼å…¥
- [ ] æ·»åŠ æˆå°±ç³»ç»Ÿ

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ç»ƒä¹ æ›²ç›®

åœ¨ `src/utils/musicUtils.ts` ä¸­åˆ›å»ºæ–°çš„ç”Ÿæˆå‡½æ•°ï¼š

```typescript
export function generateNewSheet() {
  return {
    id: 'practice-2',
    title: 'æ–°çš„ç»ƒä¹ ',
    difficulty: 'beginner',
    config: {
      clef: 'treble',
      keySignature: 'C',
      timeSignature: [4, 4],
    },
    measures: [
      { notes: [/* éŸ³ç¬¦æ•°ç»„ */] },
    ],
  };
}
```

### è‡ªå®šä¹‰éŸ³ç¬¦çŠ¶æ€é¢œè‰²

åœ¨ `src/components/Staff/StaffRenderer.tsx` çš„ `getNoteColor` å‡½æ•°ä¸­ä¿®æ”¹ï¼š

```typescript
const getNoteColor = (state: NoteState): string => {
  switch (state) {
    case NoteState.WAITING:
      return '#ä½ çš„é¢œè‰²';
    // ...
  }
};
```

## è®¸å¯è¯

MIT

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**å¼€å‘æ—¶é—´**: 2025-10-28
**ä½œè€…**: Piano Practice App Team
